#TODO: write pipeline class and finish this example